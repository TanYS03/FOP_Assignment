import java.io.*;


public class Assignment {
    public static void main(String[] args){
        // StringBuilder str = readAndWriteTextIntoFile("C:\\Users\\User\\Downloads\\extracted_log");
        // System.out.println(str);
      
        countTypesOfTasks();  


    }

    public static StringBuilder readAndWriteTextIntoFile(String filePath) {
        StringBuilder builder = new StringBuilder(); 
            try{BufferedReader reader = new BufferedReader(new FileReader(filePath));
                PrintWriter writer = new PrintWriter(new FileWriter("extracted.txt"));                                  
                String line = reader.readLine();
                    while(line != null)
                    {
                        builder.append(line);
                        builder.append(System.getProperty("line.separator"));
                        writer.println(line);
                        line = reader.readLine();                        
                    }
                        writer.flush();
                        writer.close();
                        reader.close();
           }catch (FileNotFoundException ex) {System.out.println("File not found");}
            catch (IOException e){}        
        return builder;
    }

    public static void countTypesOfTasks(String keywords){        
            try (BufferedReader reader = new BufferedReader(new FileReader("C:\\Users\\User\\Downloads\\extracted_log"))){
                String line = reader.readLine();               
                int count1 = 0;
                int count2 = 0;
                int count3 = 0;
                int count4 = 0;
                int count5 = 0;
                int count6 = 0;
                int count7 = 0;
                int count8 = 0;
                int count9 = 0;
                int count10 = 0;

                
                    while(line != null)
                    {             
                        if(line.contains("epyc")){
                            count1++;
                        }
                        else if(line.contains("opteron")){
                            count2++;
                        }               
                        else if(line.contains("gpu")){
                            count3++;
                    }
                        else if(line.contains("done")){
                            count4++;
                    }
                        else if(line.contains("error")){
                            count5++;
                    }
                        else if(line.contains("_job_complete")){
                            count6++;
                    }
                        else if(line.contains("failure")){
                            count7++;
                    }
                        else if(line.contains("kill")){
                            count8++;
                    }
                        else if(line.contains("exhausted")){
                            count9++;
                    }
                        else if(line.contains("allocate")){
                            count10++;
                    }
                        line = reader.readLine();
                    }
                    int sum = count1 + count2 + count3;
                        System.out.println("no of jobs by epyc: " + count1);
                        System.out.println("no of jobs by opteron: " + count2);
                        System.out.println("no of jobs by gpu: " + count3);
                        System.out.println("no of jobs by all partitions: " + sum);
                        System.out.println("no of jobs done: " + count4);
                        System.out.println("no of errors occur: " + count5);
                        System.out.println("no of job completed: " + count6);
                        System.out.println("no of OOM failure: " + count7);
                        System.out.println("no of killed job: " + count8);
                        System.out.println("no of time limit exhausted: " + count9);
                        System.out.println("no of jobs allocated: " + count10);

         
                        
           }catch (FileNotFoundException ex) {System.out.println("File not found");}
            catch (IOException e){}           
    }    
}
   
           //output:
           no of jobs by epyc: 3049
           no of jobs by opteron: 4971
           no of jobs by gpu: 2311
           no of jobs by all partitions: 10331
           no of jobs done: 8479
           no of errors occur: 583
           no of job completed: 8586
           no of OOM failure: 6
           no of killed job: 2424
           no of time limit exhausted: 437
           no of jobs allocated: 675
